#include "mimc.h"
#include <stddef.h>

#ifdef __cplusplus
extern "C" {
#endif

// useful to convert from big endian to little endian
#define REVERSE32(x0, x1, x2, x3, x4, x5, x6, x7) (x7), (x6), (x5), (x4), (x3), (x2), (x1), (x0)
#define REVERSE64(x0, x1, x2, x3) (x3), (x2), (x1), (x0)

enum
{
    ROUNDS_N = 110
};

bn254_64_t ROUND_C64[110] = {
    {REVERSE64(0x07d7c2f6c3a140b0, 0xab00a05982b31148, 0xf3c20093aa33413a, 0xa26d02e6750d33af)},
    {REVERSE64(0x097b91132f0d67bb, 0xf96952c095e91f8b, 0x83cfed99754c3491, 0xc875f8d5125630eb)},
    {REVERSE64(0x095ee1812d73b861, 0x781cdcdc71f86dc5, 0xafb15fb80fa89573, 0xf2e1f725ccd2792a)},
    {REVERSE64(0x2dc3d18bde2f9e6c, 0x86a8a8900e31b4c2, 0x5ea4c6f7cebadede, 0x6576ccd69273160d)},
    {REVERSE64(0x2a99531553c0ef49, 0x94ece2641003fcb7, 0x4e08888528eb749a, 0xc51e677cf9a8c46f)},
    {REVERSE64(0x22c6410a398ee262, 0x8dc6891e23d1fdca, 0x7e2b28f0f5dea150, 0x3a90f688f666d8d3)},
    {REVERSE64(0x2fe7a1c061aff3b3, 0x8f86df017170b282, 0x871da1fd926ad417, 0xc4e2a8e894f3d6dd)},
    {REVERSE64(0x257afce608375602, 0xa7fd086cc610d84e, 0x4a2407de06f8cf2d, 0xdf30e1b528d2081a)},
    {REVERSE64(0x02a9cf4b8c909d20, 0xd36dbdeaf16245b0, 0xae852e50bef5c545, 0x982c54a4b0175609)},
    {REVERSE64(0x272738a974b376ca, 0x1534ed0b1619bd22, 0x3c67d2d4481523ac, 0x35c132b4cd53caa2)},
    {REVERSE64(0x1724a9cc2b598b28, 0xf2d66330acfd4a67, 0x9a4e9bdcf63c70f7, 0x259671fb41649255)},
    {REVERSE64(0x28bfe567fe4af0e5, 0x6ead8d8ea493c7c0, 0xf00f258e9cf76f71, 0x42bf91b7f9a137f9)},
    {REVERSE64(0x0bed55e903a5d516, 0xaa5d3f7e24cf41fb, 0xcce6f258902ff7c7, 0x7e6ba580a576a4dc)},
    {REVERSE64(0x0d6fdd473822d45a, 0x3f9f08b3a6c36af4, 0x14981f8d12b8060b, 0x3fc54bd2d0f132d4)},
    {REVERSE64(0x0220c3c27d94be65, 0x59cee48efff2a7fe, 0x6a5266fcbb284449, 0x6c5ebaa6f5cf20f6)},
    {REVERSE64(0x2e8f37f2e992c407, 0x5f587e6fefc8212b, 0x3ee6df33fe57861d, 0x0b3c74b4fff2f952)},
    {REVERSE64(0x2cf6d7c7ae71156f, 0x51d9e9fccc86ac1d, 0x9fb4b82f1dbec059, 0x171b3235bf6e69c9)},
    {REVERSE64(0x1216e27ace5d2dbd, 0x1d9d13a937188ac7, 0x45b21ae52c123f19, 0xa0d2d97ce01a9bde)},
    {REVERSE64(0x2c056be4a7d23be2, 0xa2969cd68ad545bc, 0x171feab4c0d02436, 0x9e44bdebac3f7692)},
    {REVERSE64(0x0ab8814aae2d8f6b, 0x3fc157acc86c0c9b, 0x7624090e540fb7df, 0x30d6e6cd6a7812cb)},
    {REVERSE64(0x19dbcc62c4be600a, 0xf19795b828e6b1cb, 0xbaa86d77decdb85a, 0x4b2d1bdec993a200)},
    {REVERSE64(0x2ee508f621d0c5be, 0x8a3645411c5cdf48, 0x1b0ef9b031219b82, 0x0ae4506561b644d1)},
    {REVERSE64(0x0a48f6bb7a3dfbd0, 0x6f82d06a455f436d, 0xbad89164a3502e86, 0xab7196a7560d0bd3)},
    {REVERSE64(0x112795879bdf4e99, 0x9c7e4863d4a20b12, 0x5c2c0ab8c99df052, 0x6852c32e84dc779d)},
    {REVERSE64(0x24c0485129843fca, 0x7efd162500a546a0, 0x714246574a3fa751, 0x4a3a96af06ec4c0d)},
    {REVERSE64(0x0f6b85dad4de86da, 0xddec2ae2bd24e5f7, 0x14e234003aa67a95, 0xc4ce497a403f55d1)},
    {REVERSE64(0x107ace5f12d3f4f2, 0x131ed2baefa98767, 0x21d3cb8f9846138b, 0xab3d449115bcb5f3)},
    {REVERSE64(0x0d214b56d49dfd8c, 0x8f26da460308c158, 0x233ddbfa44f93013, 0xe5ec9a5f48ac7029)},
    {REVERSE64(0x16aca64040d29e88, 0x5edd7a15ae090e5a, 0x2fd4f96b64e612e7, 0x38d59305cd67a2e7)},
    {REVERSE64(0x2f668b968c546c2e, 0xbab77a38745fadcb, 0xb9ea7da84014888e, 0xe2504b69d1778217)},
    {REVERSE64(0x300bc3adf5e8b7b5, 0x23ec0e9ae33e1e53, 0x40df94dd5a9555f0, 0xf2b7900ce0a09926)},
    {REVERSE64(0x2fde4a831b7d74f3, 0x8db2c009ce03a4e5, 0x6a9b53b2b7a0c2f5, 0xe8b10a08837d5c25)},
    {REVERSE64(0x1101a1a0ab4fad96, 0xfce893960a6e2cf3, 0x05f79ac0637fdd62, 0xd4c7d0229d9c94d0)},
    {REVERSE64(0x134cfb0944350e52, 0x320febd2902d305d, 0xcb60de3cf4d9ddb1, 0xf53be98a6c7b3d9d)},
    {REVERSE64(0x00df48e696f58471, 0x7e70e863e6433044, 0x6e3a267e5237bc5f, 0x9d90562282a66759)},
    {REVERSE64(0x282e0dd6ffda4fa0, 0xdde31c7f3b8bb306, 0xb5f8ed268dabc6d9, 0xb8f8f9b7f3f48bee)},
    {REVERSE64(0x242acf77120e5542, 0x51091e336a3dc6ac, 0xfaf438a1bb1336aa, 0xfebe0576492384e9)},
    {REVERSE64(0x26bc215f1655077a, 0xe18906b673a08f3b, 0x03bf6bf822d18694, 0x9c854027cd4b1c69)},
    {REVERSE64(0x13aca8defea87661, 0x71c232879acadaa6, 0x0c35c1cf0553a4ce, 0x5474a3604ad9d601)},
    {REVERSE64(0x2e5399c3fdb75587, 0x0ab04d582f7df09d, 0xd7d71603e6d4672d, 0x0186543d7cb47b39)},
    {REVERSE64(0x20fef5146c5ff344, 0xbca1f0e516a941fc, 0xa8768cb251c09cf1, 0xdede597c9b56a766)},
    {REVERSE64(0x1563744ed1b3ddcc, 0xdeeb2bdccc0e028f, 0x7ac572821134a0dd, 0x047526397075338e)},
    {REVERSE64(0x1a09b38be95ac202, 0x10264764cf9ce59b, 0xb41398415581f556, 0xda3d1df7a9b0e111)},
    {REVERSE64(0x078f991ed3715463, 0x3733d24a164c25e3, 0x0bc92a15756ab5e0, 0xcd0347f835c35b1d)},
    {REVERSE64(0x1d294629a20e29ad, 0x4e58ada07f6ed846, 0x3642933ccfada3e3, 0x958a6cce33a6671a)},
    {REVERSE64(0x0518c6e58388be2b, 0x0db415b2d41f6ddf, 0x6ac3656fead5806f, 0xccc62f922cc38ba3)},
    {REVERSE64(0x2f30e31ecb543d08, 0x661f3b8ab557622c, 0x3f9dd00258edbc08, 0x1c9e1a5827045a4a)},
    {REVERSE64(0x24cdefdb6ce122b8, 0x54d4568b8862661f, 0x975d5a5ca944347a, 0x332260380a31cfc5)},
    {REVERSE64(0x2b34683066be3009, 0x514fa81fce113a55, 0xceb5cf69ecd04b1a, 0xe3cf90e2ba108655)},
    {REVERSE64(0x2003e7051fb9e7cc, 0x7aa63704db0146a4, 0x530972ef3fb338fd, 0x80d67e832d1e611c)},
    {REVERSE64(0x209d613fdd34dc6f, 0x61e3b050e70cca24, 0x2447266c83624c09, 0x6fd0dfc959d0f1dc)},
    {REVERSE64(0x2982fff4b9813308, 0x9438b25538b89f93, 0x442ab1bf6eb82b29, 0x222952f857e85184)},
    {REVERSE64(0x133991ea8fb29fc1, 0x9ebf8bbdbb0a6aed, 0x3c020e4a3a10f369, 0x872093ea181c5155)},
    {REVERSE64(0x14a467119a08690d, 0xaa0b16fdc3c8fb1f, 0x11766350ef3efe43, 0x34948f87b7e4fe2e)},
    {REVERSE64(0x27c8f2dd0fc16c66, 0x972bd109127f19dc, 0xe3e532aaf04415a1, 0x249c4f133234349b)},
    {REVERSE64(0x27122cf0d12c7d88, 0x65fa897c10b8d619, 0x08da77df4d6f5812, 0x0f0aade608c92ea1)},
    {REVERSE64(0x05a2dee7bcc51c57, 0xcadb3a0ae79a799d, 0x81e55923036353b9, 0xf9ce1824e2b06780)},
    {REVERSE64(0x1a53349fc7802648, 0x2a1a58ed5bf86ba9, 0xab0dc65d63c78485, 0x681526f182391ac8)},
    {REVERSE64(0x183ce6f2524a8cb0, 0x5f8e7c975ba5971c, 0x7a32652d1c5e4e6d, 0x17fc9e33a5f2e71b)},
    {REVERSE64(0x2389a28986e8bb80, 0xeead5a79dcfedf82, 0x9f7b3a5df7f3dc9f, 0xa7b6831925685df7)},
    {REVERSE64(0x0972840500fe7aaa, 0xca53b6424e03634e, 0x93184823a49542e7, 0x07c3c218c8b491d2)},
    {REVERSE64(0x0ac852d70a35a7e2, 0xe49d12b5e81385d9, 0x98e5b59abc61f21d, 0xfcacb999327282d0)},
    {REVERSE64(0x00cd593e0d3d5a9a, 0x970a5d996b59f6a4, 0x367d27fc2247a764, 0xef259d3fff72c858)},
    {REVERSE64(0x1a9e7300d7aece2b, 0xf0d6b09440d6ad34, 0x481f22871eb5f4d0, 0x7069201eec7b42fe)},
    {REVERSE64(0x0661495fc6794dd9, 0x35358407a1598bae, 0x378bbe9a0c6f0de8, 0x03e6438bca108cee)},
    {REVERSE64(0x1fc67cff27b37b5c, 0x881201314ad622ac, 0x7258cc7b89178595, 0x932ac941c12e07c7)},
    {REVERSE64(0x28e3cbc805118cbf, 0xdc3bae7e499329c3, 0xf8cc4c8c5f5208ac, 0xf215c6bed10fbc45)},
    {REVERSE64(0x031a45216c7c0048, 0x712c30b3a30c20bd, 0xe22c5b21bc8eb51a, 0xf9fa2714955d533b)},
    {REVERSE64(0x1b803ce3f48c6e20, 0x923ea0520b3c6544, 0x8047a71ff1a683c5, 0x1ecedc37f107f64f)},
    {REVERSE64(0x2a41114bd24b2485, 0xfe6e3f56faea67c1, 0xd5113fbee0f34a0a, 0x9f356f51cf7155fd)},
    {REVERSE64(0x0ce357687f7c5546, 0x75e988d935f59376, 0x42f623a427430f5c, 0x2544f839c4883c4f)},
    {REVERSE64(0x0e7f0bb128e7da97, 0x67a39c3bf7c32d39, 0x6bf5b453fc45c10a, 0xd06427b621eae891)},
    {REVERSE64(0x2bbb8b89fcab995a, 0x02ad67ee4feb6ed0, 0x69b1c3e911504069, 0x14edf28d0760af26)},
    {REVERSE64(0x22d054bc193e485a, 0xc0df7a459aebb229, 0xbd070b20e32dbcb1, 0x8cfd7bfc28dd2dbf)},
    {REVERSE64(0x2a31800f6a63c2b1, 0x79a4ce91bc678bc3, 0xedd1ee8099c39d46, 0x04d99261f5baa814)},
    {REVERSE64(0x2bf102f675cbeef3, 0xaacf27b0cfdd142a, 0x2c97fb96961fd743, 0xe669aa503c32553e)},
    {REVERSE64(0x1422364fc2659516, 0x194d3ade1ffd1b23, 0x86a5fae98d47d192, 0x46f37cd0592cfb4f)},
    {REVERSE64(0x297a5c86e4274ad2, 0x28eda1978f5651bf, 0xc9b7767c1216a3d8, 0x6a846baa6b1bb3f8)},
    {REVERSE64(0x21ad92832f5afbe6, 0x31f0691531ff064e, 0x3d88084cbfe434ed, 0x2f0808c5b4c31f81)},
    {REVERSE64(0x031496526957f169, 0x12421472d249ebbe, 0xfd6708a1b25776f0, 0x5114ae1029cf97cd)},
    {REVERSE64(0x2c02064400e1bdbe, 0xd7232bd936a27ec0, 0xf2ad460e43bd11ea, 0x02b7e01a13c5dd74)},
    {REVERSE64(0x25461087656e61a7, 0x530ea2e09ee1d5c1, 0x4c1f9c751f650c8f, 0x0f16ce7959330f44)},
    {REVERSE64(0x1e12c2812e731834, 0x6836a0466d7d92d1, 0xfa383db75028a00e, 0x7c432663bfe3d6bf)},
    {REVERSE64(0x26e9a485d59fd0b2, 0xb00dda627b4e1b72, 0x31649b84d2c0f117, 0x6259f973ae042b90)},
    {REVERSE64(0x21620790e6751f12, 0xdb962ea150a3cb97, 0xe23ebdc0b2e292e0, 0x4b5d35a7515be333)},
    {REVERSE64(0x0737287e389985cd, 0x98b8a1ce0d1c6b05, 0xa211672d33edd777, 0xec24d7da032ed534)},
    {REVERSE64(0x03d494c5faa47669, 0xfdd4ebb17b7b64a7, 0xd1d16795a480c82d, 0x9cbb0fa6a4d359e8)},
    {REVERSE64(0x28dd61f950470a96, 0x05e5146bdc380fae, 0x8e458c2e7c0775da, 0x3edc2044a30e5705)},
    {REVERSE64(0x1eebfe08edc43a1d, 0x4d8a1ed4a5295e2f, 0x3cb254598fa075d3, 0xd6550339b5ee9022)},
    {REVERSE64(0x1bb523bdf9b87656, 0xdc614a2a6b3cd66d, 0x1cb3203341e82736, 0xed8b49b4f7da6719)},
    {REVERSE64(0x078c909b378cb9d8, 0xa003df364f51f217, 0x600316ffded423b1, 0x830e2700d7c42b9c)},
    {REVERSE64(0x164d1e420bafbfac, 0x8579350dff6698c1, 0x5c9a9091ca41c817, 0xf4ce1613cce5e0ed)},
    {REVERSE64(0x013db301967c6a5a, 0x18266cb306f329a1, 0x804e5f599831e4c3, 0xe44f9ef0a27e37fb)},
    {REVERSE64(0x255695c814a957b6, 0xd177da4b4695640e, 0x3c916669b2aa2ba6, 0xb7986e2101071777)},
    {REVERSE64(0x088853138f4f5829, 0xdf632fa7c3b990d1, 0xc2943f10118fe5f2, 0xc3da22d611399fda)},
    {REVERSE64(0x24e787c48486b02e, 0x01661f0861c6bb06, 0xc0ba7577af61cbfd, 0x559ccf053ad68713)},
    {REVERSE64(0x254fc815445fdabe, 0x3b77bb5d3dd1fe51, 0x577ae022ca14ee64, 0x4021ee4fde68f1e2)},
    {REVERSE64(0x126b94d180a23226, 0xda73ff13b0b93eec, 0x70cb6df4089b049d, 0x40b334b9e0e62893)},
    {REVERSE64(0x16a907d6cdca29bd, 0xd3e94db5260d8e4d, 0x7fa4c525c6db7195, 0xcf2b1af275bcdb88)},
    {REVERSE64(0x05bcfe19a24789ff, 0x2450f768a6c4a430, 0x1c6cd0b6b42d57a0, 0x13926d40416057ed)},
    {REVERSE64(0x2f155f6a5e41664f, 0x810204ec8a8754f8, 0xd5f71b8569a6004b, 0x5d4a234af51edd39)},
    {REVERSE64(0x12d6e23456296dd3, 0xccd1f9d1f20ceddd, 0xe6f0925cb808935a, 0x0371e2af4f90c2e3)},
    {REVERSE64(0x016ebb8752796fdd, 0xe84121c1cd0de1b8, 0xeb7a6744baf7e11d, 0x6f5f746e583d4bd5)},
    {REVERSE64(0x1d32d19326658cff, 0x9a26e806fdd84c66, 0x97c6949e5b278149, 0x875fe9a187de147f)},
    {REVERSE64(0x10a4999bdf7d60b0, 0x3a4516784ac5f25d, 0x22e68629c20899e8, 0x1dd4f7ac247fcf09)},
    {REVERSE64(0x1cf7344f96c0ec20, 0xdd4a588fab465c73, 0x09b00adfce1781a8, 0xb142097b858b0c23)},
    {REVERSE64(0x21085a8583ce4789, 0xc14e7b79562d0a01, 0xee65e39d92633182, 0x4247b5dbce6ee1d1)},
    {REVERSE64(0x14b508aa823172f8, 0x34d3a51b9175d021, 0x579556211f7ed024, 0x63dacc27443781ba)},
    {REVERSE64(0x06007f823635ee5d, 0x0a6daf203c61e9bd, 0xbeb45345dad1c5e5, 0xef11a0602fbaa2e7)},
    {REVERSE64(0x1c19037951a63964, 0x5168446c1cd4e716, 0x0a15ef871da8985d, 0x299ed99123b5d60d)},
};

bn254_64_t ROUND_C_M64[110] = {
    {REVERSE64(0xc85a7767bd0d6e, 0x90326204271097b0, 0x672444a2e878dbfb, 0x7022257f996d2056)},
    {REVERSE64(0x2decc313c178d7f5, 0x98ac8f6fe262ba6c, 0xf1ad08a3383c2ff8, 0x0e92bfc0f164bf3f)},
    {REVERSE64(0x2fdd6eaaa0027023, 0x01a43f50e1eda325, 0x7c5a45627374b650, 0xce2da74c9f3b6666)},
    {REVERSE64(0x1d00db7ee12ab686, 0x13aa1d3cace7b177, 0xdffadf5cdf86c00a, 0xa9e53672fddd17ba)},
    {REVERSE64(0x20e5a055b93c9d24, 0xb8782d245555e33b, 0x543f34974d09e303, 0x5feb34a6f830f456)},
    {REVERSE64(0xeba71112870ec17, 0x44176a3664089294, 0x983c7e3edbc55cf0, 0x71919e7aaa4644fa)},
    {REVERSE64(0xd638a60b0def68, 0x33d082a32f778a62, 0xdcaec4dd66b5b454, 0xc7b5fc4f0dd804bf)},
    {REVERSE64(0x1e7270cc6eb4c578, 0x7119975f2deb5cc8, 0xa907d52b99fbe4e7, 0x919b8f7c16c7e014)},
    {REVERSE64(0x246960d07c9f3eed, 0xc714d4b1f17d2d2f, 0x1a74c7e73aa4e5dd, 0xa0419dff3c85d47b)},
    {REVERSE64(0x2dc1acd8620735e8, 0xd77d8888dd5bac02, 0x9b632599f969fbfc, 0xadefe073a2ecb491)},
    {REVERSE64(0x1326315733716291, 0xa6cec9e52f2413f5, 0x3fbf9021748c16bb, 0xc65f5ac2713077e1)},
    {REVERSE64(0xa0dd933fa5a0998, 0x3502c932f8ed7e45, 0x7189482aa0c45f11, 0x4186b6b6158803f4)},
    {REVERSE64(0xd0709cde4c5772f, 0xd9f1e88ae48f8757, 0x928c0fb9e84a88d1, 0xa3797a0f1c0ffdd4)},
    {REVERSE64(0x2fd07b1acae4b1c9, 0xeee6bb1ee3b96239, 0xf1fd857b039955eb, 0xabde808151d59772)},
    {REVERSE64(0xbdb351ed7c2f7fb, 0x4c3340c9e72ca05c, 0x612d8be24a0f8381, 0xcf98bb2241466d64)},
    {REVERSE64(0xff2b754d71f420f, 0x808fbe11edb91488, 0xfdf892df1bee2f12, 0xca1a55e80e4bc178)},
    {REVERSE64(0x2f119d13840552fc, 0x98c0b27502659fe5, 0x7c1b6f338321c548, 0xfc88c8e0952e5128)},
    {REVERSE64(0x2540730cb2d0e70, 0xdeb4ab16ad6d8c01, 0x04e17b8476de4fe9, 0x35483e2c3823e658)},
    {REVERSE64(0x7fb704f9cc07fa7, 0xaa734471dc3d3232, 0xfade732ddec60f2e, 0x93e1afc8e8284602)},
    {REVERSE64(0x1e5766ff84dcad0e, 0xefc541d6542f2f81, 0x0f25a14f22a300e7, 0x3079e0ec59ab1e4c)},
    {REVERSE64(0x16ae5da207da84db, 0xe72cb9d461d454bd, 0xede65c4fe721d458, 0xbd1a4d231d837f16)},
    {REVERSE64(0x16132d3f9b5d7236, 0x4d48d6dd9c64c5ef, 0x86c39878b0aca9c7, 0xbd105a9061f56e7d)},
    {REVERSE64(0xc9b658c5c3be426, 0x69a8a04bf95fcda8, 0x90773c2fc2fe9409, 0xf7ff759b43de890f)},
    {REVERSE64(0x80a2cb100be78c9, 0x2640b10f87961756, 0xdff41feab33f9fa4, 0xc877c2cf95772292)},
    {REVERSE64(0x1161dea55eb3d289, 0x7103666d1c87b904, 0x8def5ae173d80cfd, 0xa87a4aa5e5279df1)},
    {REVERSE64(0x24ef6b8a363fac97, 0x356c3eff158cb8a3, 0xebe41062a590574f, 0xb3657dd91c6fddf6)},
    {REVERSE64(0x17ff400b6cc94574, 0x2721311f0e774c8b, 0x29942d9e4e9b9633, 0x17d6dc9a63d1939d)},
    {REVERSE64(0xc1c051b68490a4d, 0x2f5ec48e3cc53fe2, 0xab7b030a8408df75, 0x5d8cdac8a91c7c96)},
    {REVERSE64(0x3810500b88e1736, 0xbca9aa70a6e3444b, 0xa47a07ebe4b2be2c, 0x31780e771b2a4d65)},
    {REVERSE64(0x196b7cd80d4741fd, 0x5ad9978091d18562, 0x2ed7d1a8162c26ad, 0x5b119534030a4708)},
    {REVERSE64(0xabdbb966c68f4af, 0x2d31ed1b31d0186f, 0xf2ccf2f0f3d19f19, 0xbb1b14d4e20ebe72)},
    {REVERSE64(0x156e48792ac8afff, 0xde5c940fb25c38af, 0xba68277911e284ff, 0x3219be770ae108d8)},
    {REVERSE64(0x1d512a66bd62c5f2, 0x829ebf443a1b4c91, 0xae7b21215b4ff324, 0xda157da3d7a20a94)},
    {REVERSE64(0x1cfac621e85d348a, 0x2c16a3d31322c128, 0x4f825e49a549f8e2, 0x054df54338832122)},
    {REVERSE64(0x2b7fe608b2f897ad, 0xf430d410b66e7c61, 0x0ef219800d4044de, 0xe2ef17862374ac26)},
    {REVERSE64(0x30979cfbae6e9aca, 0x11178fe2e09ede49, 0xad1ec94f04357a55, 0xc328c8a6a32d9fef)},
    {REVERSE64(0xc420ad58860898a, 0x083f794d6c1ddb83, 0xa7d0fedaf5ef02f7, 0x9db091a05fa10b66)},
    {REVERSE64(0x1fde911d94ad8226, 0xd3147821f314fc03, 0x94d2c69eecb87d8c, 0x4d9aeeb93dbc4d82)},
    {REVERSE64(0x289cd726805525b, 0xfe5c6858fff24cc7, 0xc1442469e929d42d, 0xc2be6cc60c8770f4)},
    {REVERSE64(0x22714ea57f320baa, 0xa98fef0f96215fa1, 0xce8d5e69f90c5538, 0x919bb4041f4a1d62)},
    {REVERSE64(0x4db7f20363a82c7, 0xa33abc838ca772f7, 0xee6c26c123c9a2b8, 0x60a0de7cfb34ef7e)},
    {REVERSE64(0x20ba308f447c00d6, 0x16591b6679e9f3da, 0xb96566a7ef1072d7, 0xc4382afba63089cd)},
    {REVERSE64(0xd4dc96e66d0524b, 0xb322c735ada0a2ad, 0xfb251ee582af0998, 0xec3ac973f2aeb614)},
    {REVERSE64(0x6610bcf3af70046, 0xc728475cf3a6c164, 0x7b50483a81683020, 0x3cd560206986f4e1)},
    {REVERSE64(0x2ab28d2ea757a5ad, 0x361fe6bb39799dce, 0x109a11875458a9d8, 0x229142b582598ce8)},
    {REVERSE64(0x11024aff23664596, 0x3663e03ecdc2cc49, 0x9e579f900365b33e, 0x3d05dd29709eef66)},
    {REVERSE64(0x5397b815aa709b1, 0x98b980603c571c0b, 0x724dadc44ece7b9d, 0xd7bd1e2d587b555d)},
    {REVERSE64(0x1c8de409dd645939, 0x8f9af7f6652c5b88, 0xb0e5c6e7c0a0356c, 0x5e1374343e086554)},
    {REVERSE64(0x240e564b8e140343, 0x3b7f11aa64aa9230, 0x68a225517eb1bcc7, 0x044a7679adaa4fa3)},
    {REVERSE64(0xea89a795ba68579, 0x465886e62192b3d1, 0x9ee866602e05c416, 0xb5dc518e287cd44b)},
    {REVERSE64(0x21c3a55e8b3c1c9d, 0x71345f54d9e00392, 0x3682424e390b7b86, 0x1e77c836e18a0aa4)},
    {REVERSE64(0x75ec7ff5fec9ac5, 0xe0f432f9ebe9d799, 0x2224172a34b75daa, 0xda7d506b3ea29f45)},
    {REVERSE64(0xe2d83b5390f92f0, 0x5c8024b5446ae615, 0x84c8577a72f3cd9a, 0xeed4da39a2b7d311)},
    {REVERSE64(0x27bd999fd52afc1a, 0xba4bce0af764a895, 0x2452fa5cbd60a6ed, 0x72c9854e4e0ae1ac)},
    {REVERSE64(0x25eabc3e0957c902, 0x4ddbb20062200748, 0xefb95042bef8897f, 0x1f24d7c45e89c9ac)},
    {REVERSE64(0x307a40f3051f6a5, 0x203f5843991cb40f, 0xc7b2734b631a75ac, 0xc0425d3d94a7936f)},
    {REVERSE64(0x19c78b81542dbe4c, 0x833d154e77bef4cf, 0x79e0e112dde36e8d, 0x6d8a6e8f5fa37462)},
    {REVERSE64(0x22743358945cd706, 0xb4909f3ce6b8c6a6, 0x767ca3d9f9fbc879, 0xececce4786490fa9)},
    {REVERSE64(0x219d92875fe080c2, 0x98108641b093dbbf, 0xf67b011d8d4aac7c, 0x17e4f736d3efd360)},
    {REVERSE64(0x1150b097e1dbf20f, 0xbef89f6ef32ea7fd, 0x037bf2f2980b9320, 0xc732f21b21e6e11f)},
    {REVERSE64(0x14f37758d5f6fecb, 0x3f350f5de8823b71, 0x6629cb0e008ba552, 0x38fc18cd10448770)},
    {REVERSE64(0x18e33e40e6153d03, 0x21a7e0e71271c30a, 0xf30c5fc561fbf78f, 0x525789492d403596)},
    {REVERSE64(0x149966cdaea62d00, 0x922265763d99643f, 0xa66110904f6d508c, 0xd42ca9cca729e243)},
    {REVERSE64(0x13068c9a6402130, 0x1ccfa17616a9bdfb, 0x16c60625f8a79540, 0x8c16e52eaefb8d3c)},
    {REVERSE64(0x62458defac545cf, 0xc558058ea24fed84, 0xa82d12c3e6c865b1, 0x3c39129f79ac50cf)},
    {REVERSE64(0x227e7156a68f9109, 0x3fafc0d652a66edb, 0x340798b127fe0bb7, 0xeeb0972a9055081f)},
    {REVERSE64(0x25ab8efd72a3583a, 0x8622a0b8b0b6294b, 0x4731bf3c98710466, 0x5798b1b60b453923)},
    {REVERSE64(0x1c0b5abfd179cfde, 0x96e3bc82e00a5210, 0x6e2698583358b884, 0xbeaf75d9ed265c6c)},
    {REVERSE64(0x256b345e11a288c4, 0xc3257ec67358ffb1, 0xdd501b66416a97c0, 0x6f9f154d0db0e9d0)},
    {REVERSE64(0xa7035aa540f4e21, 0x0d5018db4a69c981, 0x5177519eb15fa367, 0xea324974a55dc700)},
    {REVERSE64(0x2f0db8fc60e769c0, 0x4dec075377776192, 0xd6017b597647f248, 0xf72290814f9a214f)},
    {REVERSE64(0xc0e9e0119f18712, 0x40ee77b00145004e, 0xb1e41558da604e0c, 0x6cb583dc01fdd647)},
    {REVERSE64(0x5512e9f444d096c, 0xa081134b9475c117, 0xc6ac22c89888e11a, 0x7f2a7b33420f42e0)},
    {REVERSE64(0x2c0994d4435fd6f9, 0xaa2451f8b6ed4d73, 0x99621b224fb73bc2, 0x29bb2fb533399677)},
    {REVERSE64(0xf6a838c036b8562, 0x8e408ca8d0930257, 0x4f541d063383e812, 0x390702b1477fbcfc)},
    {REVERSE64(0x19b6ae06b9ff7244, 0xca0d53cade4b77e8, 0xc736b8ece2edfd50, 0x1a3a25d3fe257499)},
    {REVERSE64(0x1be644d279f0916b, 0x7c36e7884cf9b692, 0x0fff132e9d0467f4, 0xf910b6cbdf60bd1c)},
    {REVERSE64(0x2a8ff7790bad39f, 0xdbbf7721b85e7228, 0x9c7b84eff8fcc2ef, 0xc720c47aa8e25898)},
    {REVERSE64(0x2c7f2051aca3198e, 0xb36ae4b559d732bf, 0xa06bd328efc73497, 0x075443df25dff7d3)},
    {REVERSE64(0x58fa560349e3bb9, 0x6325e5f0f53b06c5, 0xd913f52e4ec74a80, 0x3250f459d9aad560)},
    {REVERSE64(0x26d54da05d0df88b, 0x533e842acbc550d8, 0x043d586fa802136c, 0x289d7acf457e3e06)},
    {REVERSE64(0x13f46b561a1ad78d, 0x56fc55e104a2c8e8, 0x5f77825ee8144396, 0xb30fe9da9b52e9ba)},
    {REVERSE64(0x2388b7f1d0722a19, 0x6d452bf4362a6d5e, 0xfba59cfe0ba52418, 0x8f05cc44e014bb07)},
    {REVERSE64(0x1a3ce2657126058, 0x5378c0624341a105, 0xdf6db45146699346, 0xfe8023b53b674b72)},
    {REVERSE64(0x1ad5651004cd406d, 0x0c362c04e6c89995, 0x850fef38dee8f8c8, 0x66841e22d1e7d817)},
    {REVERSE64(0x24c299aa2ad08f3e, 0xd3bc04ba270e85ca, 0x30106a88a4d51644, 0xb81298feaf59ec59)},
    {REVERSE64(0x295f115f3ae3ffdd, 0x730173838931c4c4, 0x41e8db4f1b8d6afa, 0x1513fa93d44dbafb)},
    {REVERSE64(0xaa5a7b14696d77b, 0x8b5d02752fed11b1, 0xc394ef28e1e74d03, 0x645520f338a210c1)},
    {REVERSE64(0xe93bb1a503ca86, 0xe82bc3a5d8067987, 0xcc7edb18f3d77f5a, 0xf57b0a1533e3e2f4)},
    {REVERSE64(0x1494ca9b0e709297, 0x7a9a513c9ba493a1, 0x7e25504efff2d0a4, 0x56d54952f200faff)},
    {REVERSE64(0x2011f17d72fedf53, 0xaa7caee396ca7ba3, 0x456d289c9a951f35, 0x5570c06e0e3c3092)},
    {REVERSE64(0x300af89afcafe2ae, 0x63271ea8b8a4ddd1, 0xf1ba6bb19eb8a239, 0x0f00c639abb2cf9d)},
    {REVERSE64(0xae3f2abfe6b73b4, 0x52af26cc1f186829, 0xd6f77665ea95fb50, 0xc82ad087a59f0795)},
    {REVERSE64(0x166189f99121c5cb, 0x77b4b70e4e2623cf, 0x3474bc53cde77b2e, 0xc8ae54c58b8b51e2)},
    {REVERSE64(0x1fd35403643daaee, 0x672a2bc9d91d23e4, 0xc2da18266196ef8e, 0x4caf0aeb6a88f471)},
    {REVERSE64(0x1b7d847e7bf513fd, 0x05e56c8c9edae23b, 0xded33766a427900a, 0x854a5a5edeba3724)},
    {REVERSE64(0x8cd05a14b8cedce, 0x4d5422c62f7c347c, 0x160cc7db209af18e, 0xa665399f78106f8b)},
    {REVERSE64(0x1337cbf6a1d678e6, 0x6781c32d8f79cae8, 0x92101809e5e64fd7, 0x0e7d06e4fba37de0)},
    {REVERSE64(0x203df6f3be43247d, 0xd45fca76d1f927db, 0x777ab7e5f19b1e81, 0x98df9aede8f99107)},
    {REVERSE64(0x3d29d893b237cd3, 0x588ebbbab672b424, 0xa5f4e75fe8a10454, 0x8054c26fc38775bd)},
    {REVERSE64(0x15edf9312fb17bec, 0xeab3a617467fec14, 0xfccbac31c475b0c8, 0x7f6e5efe3d4bda0b)},
    {REVERSE64(0x2e3e8f56208169d5, 0x23bc2535f121959a, 0xe78315803f149152, 0xd85a10eb67040042)},
    {REVERSE64(0x13b0a74839faf094, 0xb1f9fd89a20df5b4, 0x14087a0ae2f59513, 0x8202b99e0f6a2a19)},
    {REVERSE64(0x1bd9992f1a105d9, 0xa0a31fb8a6dc2c85, 0x526876b8742c86e9, 0x3feee36fa3ee52f6)},
    {REVERSE64(0x23decad540efc76d, 0xb0fcb460fad88ec3, 0x2fd84e874bffb8ce, 0x9201dd3bd440dfd8)},
    {REVERSE64(0x47a6d4a4892a118, 0x4d3a09cdb3661ce3, 0x5ac26a80a9fd230e, 0xabd212a488e30c83)},
    {REVERSE64(0x90c015f5480fc0a, 0x95f6bc73cd770daa, 0x644a24ee1177032c, 0x4b5ddc1a510aa83a)},
    {REVERSE64(0x1e81ac07aa105a81, 0x286abd43a6578568, 0xef1513a436315982, 0x0ce483039d408a97)},
    {REVERSE64(0x1d18de74b26216c4, 0xd57e2405c932262f, 0x46f94ba0dd0e1ba8, 0x9ad0ed291763a571)},
    {REVERSE64(0x11097756a27b90c0, 0xd94696bfc7b67986, 0x49692da3c94ec182, 0xeae023cee61c4eea)},
};

void mimc_enc64(bn254_64_t *msg, const bn254_64_t *key)
{
#define MIMC_ROUND(i)                                                                              \
    bn254_add64(msg, key);                                                                         \
    bn254_add64(msg, &ROUND_C64[i]);                                                               \
    t = *msg;                                                                                      \
    bn254_sqr64(msg);                                                                              \
    bn254_sqr64(msg);                                                                              \
    bn254_mul64(msg, &t);

#define MIMC_ROUND2(i) MIMC_ROUND(i + 0) MIMC_ROUND(i + 1)

#define MIMC_ROUND4(i) MIMC_ROUND2(i + 0) MIMC_ROUND2(i + 2)
#define MIMC_ROUND8(i) MIMC_ROUND4(i + 0) MIMC_ROUND4(i + 4)
#define MIMC_ROUND16(i) MIMC_ROUND8(i + 0) MIMC_ROUND8(i + 8)
#define MIMC_ROUND32(i) MIMC_ROUND16(i + 0) MIMC_ROUND16(i + 16)
#define MIMC_ROUND64(i) MIMC_ROUND32(i + 0) MIMC_ROUND32(i + 32)

    bn254_64_t t;

    MIMC_ROUND64(0);
    MIMC_ROUND32(64);
    MIMC_ROUND8(96);
    MIMC_ROUND4(104);
    MIMC_ROUND2(108);

#undef MIMC_ROUND64
#undef MIMC_ROUND32
#undef MIMC_ROUND16
#undef MIMC_ROUND8
#undef MIMC_ROUND4
#undef MIMC_ROUND2
#undef MIMC_ROUND
}

void mimc_enc64_v2(bn254_64_t *msg, const bn254_64_t *key)
{
#define MIMC_ROUND(i)                                                                              \
    bn254_add_nofix64(msg, &mk);                                                                   \
    bn254_add_nofix64(msg, &ROUND_C_M64[i]);                                                       \
                                                                                                   \
    t = *msg;                                                                                      \
    bn254_monty_sqr_nofix64(msg);                                                                  \
    bn254_monty_sqr_nofix64(msg);                                                                  \
    bn254_monty_mul_nofix64(msg, &t);                                                              \
    bn254_fix_of64(msg);

#define MIMC_ROUND2(i) MIMC_ROUND(i + 0) MIMC_ROUND(i + 1)

#define MIMC_ROUND4(i) MIMC_ROUND2(i + 0) MIMC_ROUND2(i + 2)
#define MIMC_ROUND8(i) MIMC_ROUND4(i + 0) MIMC_ROUND4(i + 4)
#define MIMC_ROUND16(i) MIMC_ROUND8(i + 0) MIMC_ROUND8(i + 8)
#define MIMC_ROUND32(i) MIMC_ROUND16(i + 0) MIMC_ROUND16(i + 16)
#define MIMC_ROUND64(i) MIMC_ROUND32(i + 0) MIMC_ROUND32(i + 32)

    bn254_64_t mk = *key;
    bn254_64_t t = *msg;

    bn254_into_the_montyverse64(msg);
    bn254_into_the_montyverse64(&mk);

    MIMC_ROUND64(0);
    MIMC_ROUND32(64);
    MIMC_ROUND8(96);
    MIMC_ROUND4(104);
    MIMC_ROUND2(108);

    bn254_outta_the_montyverse64(msg);

#undef MIMC_ROUND64
#undef MIMC_ROUND32
#undef MIMC_ROUND16
#undef MIMC_ROUND8
#undef MIMC_ROUND4
#undef MIMC_ROUND2
#undef MIMC_ROUND
}

#ifdef __cplusplus
}
#endif
